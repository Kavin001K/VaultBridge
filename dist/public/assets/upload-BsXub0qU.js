import{c as ne,r as u,j as e,X as Re,b as Ae,d as ze,e as Ue,f as Be,g as F,P as X,h as O,i as _e,a as Te,k as Fe,u as $e,L as ce,B as J}from"./index-Dr8jgfVR.js";import{A as ue}from"./index-CHBNmsLK.js";import{m as k}from"./proxy-N6T_XOox.js";import{F as Ke}from"./file-nX0MUDcX.js";import{K as Le}from"./key-B79qRl8B.js";import{F as Ve}from"./file-text-mROjMxDd.js";import{U as me}from"./upload-DDG7Rga8.js";import{L as Oe}from"./lock-CPplcc9H.js";import{u as He,a as Ge,b as We}from"./use-vaults-MLlSs9OK.js";import{g as Ye,a as Xe,w as qe,b as Ze,e as Je}from"./crypto-DWfN9eO7.js";import{A as Qe}from"./arrow-left-C8ze6UP3.js";import{Z as et}from"./zap-DJWQmGPV.js";import{S as tt}from"./shield-9v7kfTWE.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=ne("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=ne("CloudUpload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=ne("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);function nt({onFilesSelected:t,disabled:r,onDragStateChange:s}){const[a,i]=u.useState(!1),[o,n]=u.useState([]);u.useEffect(()=>{s==null||s(a)},[a,s]);const l=d=>{d.preventDefault(),r||i(!0)},m=()=>i(!1),x=d=>{if(d.preventDefault(),i(!1),!r&&d.dataTransfer.files&&d.dataTransfer.files.length>0){const p=Array.from(d.dataTransfer.files);n(p),t(p)}},v=d=>{if(d.target.files&&d.target.files.length>0){const p=Array.from(d.target.files);n(p),t(p)}},c=d=>{const p=o.filter((w,g)=>g!==d);n(p),t(p)},h=o.reduce((d,p)=>d+p.size,0);return e.jsxs("div",{className:"w-full space-y-4",children:[e.jsxs("div",{onDragOver:l,onDragLeave:m,onDrop:x,className:`
          relative group cursor-pointer
          border-2 border-dashed rounded-xl p-10
          transition-all duration-300 ease-in-out
          flex flex-col items-center justify-center text-center
          ${a?"border-primary bg-primary/5 shadow-[0_0_30px_rgba(34,197,94,0.1)]":"border-border hover:border-primary/50 hover:bg-secondary/30"}
          ${r?"opacity-50 cursor-not-allowed":""}
        `,children:[e.jsx("input",{type:"file",multiple:!0,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer disabled:cursor-not-allowed",onChange:v,disabled:r}),e.jsx("div",{className:"w-16 h-16 mb-4 rounded-full bg-secondary flex items-center justify-center group-hover:scale-110 transition-transform duration-300",children:e.jsx(rt,{className:`w-8 h-8 ${a?"text-primary":"text-muted-foreground"}`})}),e.jsx("h3",{className:"text-lg font-semibold mb-1",children:a?"Drop it securely":"Drag & drop files here"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"or click to browse from your device"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-4 font-mono",children:"Max file size: Unlimited (Chunked Upload)"})]}),e.jsx(ue,{children:o.length>0&&e.jsxs(k.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center text-xs uppercase tracking-wider font-mono text-muted-foreground mb-2",children:[e.jsxs("span",{children:["Selected Files (",o.length,")"]}),e.jsxs("span",{children:[(h/(1024*1024)).toFixed(2)," MB Total"]})]}),o.map((d,p)=>e.jsxs(k.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},className:"flex items-center justify-between p-3 bg-secondary/30 rounded-lg border border-border group",children:[e.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[e.jsx("div",{className:"p-2 bg-background rounded-md",children:e.jsx(Ke,{className:"w-4 h-4 text-primary"})}),e.jsxs("div",{className:"truncate",children:[e.jsx("p",{className:"text-sm font-medium truncate max-w-[200px]",children:d.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[(d.size/1024).toFixed(1)," KB"]})]})]}),!r&&e.jsx("button",{onClick:()=>c(p),className:"p-2 hover:bg-destructive/10 hover:text-destructive rounded-full transition-colors",children:e.jsx(Re,{className:"w-4 h-4"})})]},`${d.name}-${p}`))]})})]})}const de=[{id:"keys",label:"Generating Keys",icon:Le},{id:"metadata",label:"Encrypting Metadata",icon:Ve},{id:"transfer",label:"Encrypting & Uploading",icon:me},{id:"done",label:"Complete",icon:Q}];function at({stage:t,step:r,progress:s,statusText:a}){const i=de.findIndex(o=>o.id===r);return e.jsxs(k.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"w-full max-w-md mx-auto text-center px-4",children:[e.jsxs(k.div,{animate:{rotate:t==="encrypting"?[0,10,-10,0]:0,scale:t==="success"?[1,1.2,1]:1},transition:{duration:.5,repeat:t==="encrypting"?1/0:0,repeatDelay:1},className:"w-16 h-16 md:w-20 md:h-20 mx-auto mb-6 relative",children:[e.jsx("div",{className:`w-full h-full rounded-2xl flex items-center justify-center ${t==="success"?"bg-primary/20 border-2 border-primary":"bg-zinc-800 border border-zinc-700"}`,children:t==="success"?e.jsx(Q,{className:"w-8 h-8 md:w-10 md:h-10 text-primary"}):e.jsx(Oe,{className:"w-8 h-8 md:w-10 md:h-10 text-primary animate-pulse"})}),t!=="success"&&e.jsx(e.Fragment,{children:[0,1,2].map(o=>e.jsx(k.div,{className:"absolute w-2 h-2 bg-primary rounded-full",animate:{x:[0,40,0,-40,0],y:[-40,0,40,0,-40],opacity:[.3,1,.3]},transition:{duration:3,repeat:1/0,delay:o*1,ease:"easeInOut"},style:{top:"50%",left:"50%",marginLeft:-4,marginTop:-4}},o))})]}),e.jsx(k.h3,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"text-lg md:text-xl font-bold mb-2 font-mono break-words line-clamp-2 min-h-[3.5rem] flex items-center justify-center",children:a},a),e.jsx("div",{className:"w-full h-2 bg-zinc-800 rounded-full overflow-hidden mb-6",children:e.jsx(k.div,{initial:{width:0},animate:{width:`${s}%`},transition:{duration:.3,ease:"easeOut"},className:"h-full bg-gradient-to-r from-primary via-emerald-400 to-primary rounded-full",style:{backgroundSize:"200% 100%",animation:"shimmer 2s linear infinite"}})}),e.jsxs("div",{className:"text-3xl md:text-4xl font-mono font-bold text-primary mb-8",children:[Math.round(s),"%"]}),e.jsx("div",{className:"space-y-2 text-left bg-zinc-900/50 p-4 rounded-xl",children:de.map((o,n)=>{const l=o.id===r,m=n<i,x=n>i,v=o.icon;return e.jsxs(k.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:n*.1},className:`progress-step ${l?"active":""} ${m?"completed":""} ${x?"pending":""}`,children:[e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center shrink-0 ${m?"bg-primary/20":l?"bg-primary/10":"bg-zinc-800"}`,children:m?e.jsx(Q,{className:"w-4 h-4 text-primary"}):l?e.jsx(Ae,{className:"w-4 h-4 text-primary animate-spin"}):e.jsx(v,{className:"w-3 h-3"})}),e.jsx("span",{className:"text-xs md:text-sm font-mono truncate",children:o.label})]},o.id)})}),e.jsx("div",{className:"mt-8 font-mono text-[10px] text-primary/30 overflow-hidden",children:e.jsx(k.div,{animate:{y:[-20,0]},transition:{duration:2,repeat:1/0,ease:"linear"},children:Array.from({length:3},(o,n)=>e.jsx("div",{className:"opacity-50",children:Array.from({length:40},()=>String.fromCharCode(33+Math.floor(Math.random()*94))).join("")},n))})}),e.jsx("style",{children:`
        @keyframes shimmer {
          0% { background-position: 200% 0; }
          100% { background-position: -200% 0; }
        }
      `})]})}function fe(t,[r,s]){return Math.min(s,Math.max(r,t))}var it=u.createContext(void 0);function ot(t){const r=u.useContext(it);return t||r||"ltr"}function lt(t){const r=u.useRef({value:t,previous:t});return u.useMemo(()=>(r.current.value!==t&&(r.current.previous=r.current.value,r.current.value=t),r.current.previous),[t])}var pe=["PageUp","PageDown"],xe=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],he={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},$="Slider",[ee,ct,dt]=Be($),[ye]=Ue($,[dt]),[ut,q]=ye($),ge=u.forwardRef((t,r)=>{const{name:s,min:a=0,max:i=100,step:o=1,orientation:n="horizontal",disabled:l=!1,minStepsBetweenThumbs:m=0,defaultValue:x=[a],value:v,onValueChange:c=()=>{},onValueCommit:h=()=>{},inverted:d=!1,form:p,...w}=t,g=u.useRef(new Set),y=u.useRef(0),S=n==="horizontal"?mt:ft,[j=[],_]=ze({prop:v,defaultProp:x,onChange:N=>{var E;(E=[...g.current][y.current])==null||E.focus(),c(N)}}),K=u.useRef(j);function b(N){const P=gt(j,N);C(N,P)}function M(N){C(N,y.current)}function R(){const N=K.current[y.current];j[y.current]!==N&&h(j)}function C(N,P,{commit:E}={commit:!1}){const H=jt(o),T=Nt(Math.round((N-a)/o)*o+a,H),I=fe(T,[a,i]);_((U=[])=>{const f=ht(U,I,P);if(wt(f,m*o)){y.current=f.indexOf(I);const D=String(f)!==String(U);return D&&E&&h(f),D?f:U}else return U})}return e.jsx(ut,{scope:t.__scopeSlider,name:s,disabled:l,min:a,max:i,valueIndexToChangeRef:y,thumbs:g.current,values:j,orientation:n,form:p,children:e.jsx(ee.Provider,{scope:t.__scopeSlider,children:e.jsx(ee.Slot,{scope:t.__scopeSlider,children:e.jsx(S,{"aria-disabled":l,"data-disabled":l?"":void 0,...w,ref:r,onPointerDown:F(w.onPointerDown,()=>{l||(K.current=j)}),min:a,max:i,inverted:d,onSlideStart:l?void 0:b,onSlideMove:l?void 0:M,onSlideEnd:l?void 0:R,onHomeKeyDown:()=>!l&&C(a,0,{commit:!0}),onEndKeyDown:()=>!l&&C(i,j.length-1,{commit:!0}),onStepKeyDown:({event:N,direction:P})=>{if(!l){const T=pe.includes(N.key)||N.shiftKey&&xe.includes(N.key)?10:1,I=y.current,U=j[I],f=o*T*P;C(U+f,I,{commit:!0})}}})})})})});ge.displayName=$;var[be,ve]=ye($,{startEdge:"left",endEdge:"right",size:"width",direction:1}),mt=u.forwardRef((t,r)=>{const{min:s,max:a,dir:i,inverted:o,onSlideStart:n,onSlideMove:l,onSlideEnd:m,onStepKeyDown:x,...v}=t,[c,h]=u.useState(null),d=O(r,S=>h(S)),p=u.useRef(void 0),w=ot(i),g=w==="ltr",y=g&&!o||!g&&o;function z(S){const j=p.current||c.getBoundingClientRect(),_=[0,j.width],b=ae(_,y?[s,a]:[a,s]);return p.current=j,b(S-j.left)}return e.jsx(be,{scope:t.__scopeSlider,startEdge:y?"left":"right",endEdge:y?"right":"left",direction:y?1:-1,size:"width",children:e.jsx(we,{dir:w,"data-orientation":"horizontal",...v,ref:d,style:{...v.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:S=>{const j=z(S.clientX);n==null||n(j)},onSlideMove:S=>{const j=z(S.clientX);l==null||l(j)},onSlideEnd:()=>{p.current=void 0,m==null||m()},onStepKeyDown:S=>{const _=he[y?"from-left":"from-right"].includes(S.key);x==null||x({event:S,direction:_?-1:1})}})})}),ft=u.forwardRef((t,r)=>{const{min:s,max:a,inverted:i,onSlideStart:o,onSlideMove:n,onSlideEnd:l,onStepKeyDown:m,...x}=t,v=u.useRef(null),c=O(r,v),h=u.useRef(void 0),d=!i;function p(w){const g=h.current||v.current.getBoundingClientRect(),y=[0,g.height],S=ae(y,d?[a,s]:[s,a]);return h.current=g,S(w-g.top)}return e.jsx(be,{scope:t.__scopeSlider,startEdge:d?"bottom":"top",endEdge:d?"top":"bottom",size:"height",direction:d?1:-1,children:e.jsx(we,{"data-orientation":"vertical",...x,ref:c,style:{...x.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:w=>{const g=p(w.clientY);o==null||o(g)},onSlideMove:w=>{const g=p(w.clientY);n==null||n(g)},onSlideEnd:()=>{h.current=void 0,l==null||l()},onStepKeyDown:w=>{const y=he[d?"from-bottom":"from-top"].includes(w.key);m==null||m({event:w,direction:y?-1:1})}})})}),we=u.forwardRef((t,r)=>{const{__scopeSlider:s,onSlideStart:a,onSlideMove:i,onSlideEnd:o,onHomeKeyDown:n,onEndKeyDown:l,onStepKeyDown:m,...x}=t,v=q($,s);return e.jsx(X.span,{...x,ref:r,onKeyDown:F(t.onKeyDown,c=>{c.key==="Home"?(n(c),c.preventDefault()):c.key==="End"?(l(c),c.preventDefault()):pe.concat(xe).includes(c.key)&&(m(c),c.preventDefault())}),onPointerDown:F(t.onPointerDown,c=>{const h=c.target;h.setPointerCapture(c.pointerId),c.preventDefault(),v.thumbs.has(h)?h.focus():a(c)}),onPointerMove:F(t.onPointerMove,c=>{c.target.hasPointerCapture(c.pointerId)&&i(c)}),onPointerUp:F(t.onPointerUp,c=>{const h=c.target;h.hasPointerCapture(c.pointerId)&&(h.releasePointerCapture(c.pointerId),o(c))})})}),je="SliderTrack",Ne=u.forwardRef((t,r)=>{const{__scopeSlider:s,...a}=t,i=q(je,s);return e.jsx(X.span,{"data-disabled":i.disabled?"":void 0,"data-orientation":i.orientation,...a,ref:r})});Ne.displayName=je;var te="SliderRange",Se=u.forwardRef((t,r)=>{const{__scopeSlider:s,...a}=t,i=q(te,s),o=ve(te,s),n=u.useRef(null),l=O(r,n),m=i.values.length,x=i.values.map(h=>Ce(h,i.min,i.max)),v=m>1?Math.min(...x):0,c=100-Math.max(...x);return e.jsx(X.span,{"data-orientation":i.orientation,"data-disabled":i.disabled?"":void 0,...a,ref:l,style:{...t.style,[o.startEdge]:v+"%",[o.endEdge]:c+"%"}})});Se.displayName=te;var re="SliderThumb",ke=u.forwardRef((t,r)=>{const s=ct(t.__scopeSlider),[a,i]=u.useState(null),o=O(r,l=>i(l)),n=u.useMemo(()=>a?s().findIndex(l=>l.ref.current===a):-1,[s,a]);return e.jsx(pt,{...t,ref:o,index:n})}),pt=u.forwardRef((t,r)=>{const{__scopeSlider:s,index:a,name:i,...o}=t,n=q(re,s),l=ve(re,s),[m,x]=u.useState(null),v=O(r,z=>x(z)),c=m?n.form||!!m.closest("form"):!0,h=_e(m),d=n.values[a],p=d===void 0?0:Ce(d,n.min,n.max),w=yt(a,n.values.length),g=h==null?void 0:h[l.size],y=g?bt(g,p,l.direction):0;return u.useEffect(()=>{if(m)return n.thumbs.add(m),()=>{n.thumbs.delete(m)}},[m,n.thumbs]),e.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[l.startEdge]:`calc(${p}% + ${y}px)`},children:[e.jsx(ee.ItemSlot,{scope:t.__scopeSlider,children:e.jsx(X.span,{role:"slider","aria-label":t["aria-label"]||w,"aria-valuemin":n.min,"aria-valuenow":d,"aria-valuemax":n.max,"aria-orientation":n.orientation,"data-orientation":n.orientation,"data-disabled":n.disabled?"":void 0,tabIndex:n.disabled?void 0:0,...o,ref:v,style:d===void 0?{display:"none"}:t.style,onFocus:F(t.onFocus,()=>{n.valueIndexToChangeRef.current=a})})}),c&&e.jsx(xt,{name:i??(n.name?n.name+(n.values.length>1?"[]":""):void 0),form:n.form,value:d},a)]})});ke.displayName=re;var xt=t=>{const{value:r,...s}=t,a=u.useRef(null),i=lt(r);return u.useEffect(()=>{const o=a.current,n=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(n,"value").set;if(i!==r&&m){const x=new Event("input",{bubbles:!0});m.call(o,r),o.dispatchEvent(x)}},[i,r]),e.jsx("input",{style:{display:"none"},...s,ref:a,defaultValue:r})};function ht(t=[],r,s){const a=[...t];return a[s]=r,a.sort((i,o)=>i-o)}function Ce(t,r,s){const o=100/(s-r)*(t-r);return fe(o,[0,100])}function yt(t,r){return r>2?`Value ${t+1} of ${r}`:r===2?["Minimum","Maximum"][t]:void 0}function gt(t,r){if(t.length===1)return 0;const s=t.map(i=>Math.abs(i-r)),a=Math.min(...s);return s.indexOf(a)}function bt(t,r,s){const a=t/2,o=ae([0,50],[0,a]);return(a-o(r)*s)*s}function vt(t){return t.slice(0,-1).map((r,s)=>t[s+1]-r)}function wt(t,r){if(r>0){const s=vt(t);return Math.min(...s)>=r}return!0}function ae(t,r){return s=>{if(t[0]===t[1]||r[0]===r[1])return r[0];const a=(r[1]-r[0])/(t[1]-t[0]);return r[0]+a*(s-t[0])}}function jt(t){return(String(t).split(".")[1]||"").length}function Nt(t,r){const s=Math.pow(10,r);return Math.round(t*s)/s}var De=ge,St=Ne,kt=Se,Ct=ke;const se=u.forwardRef(({className:t,...r},s)=>e.jsxs(De,{ref:s,className:Te("relative flex w-full touch-none select-none items-center",t),...r,children:[e.jsx(St,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:e.jsx(kt,{className:"absolute h-full bg-primary"})}),e.jsx(Ct,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));se.displayName=De.displayName;const Y=5*1024*1024;function Kt(){const[t,r]=u.useState([]),[s,a]=u.useState([24]),[i,o]=u.useState([5]),[n,l]=u.useState("idle"),[m,x]=u.useState("keys"),[v,c]=u.useState(0),[h,d]=u.useState(""),[p,w]=u.useState(!1),[,g]=Fe(),{toast:y}=$e(),z=He(),S=Ge(),j=We(),_=(b,M=20)=>{if(b.length<=M)return b;const R=b.lastIndexOf(".");if(R!==-1){const C=b.substring(R),N=b.substring(0,R);if(N.length>M-C.length-3)return N.substring(0,M-C.length-3)+"..."+C}return b.substring(0,M-3)+"..."},K=async()=>{if(t.length!==0){l("encrypting"),c(0);try{x("keys"),d("Generating AES-256-GCM encryption key..."),await new Promise(f=>setTimeout(f,500));const b=await Ye(),M=Xe();d("Wrapping key with PIN protection...");const R=await qe(b,M.pin);c(10),x("metadata"),d(`Encrypting metadata for ${t.length} file${t.length>1?"s":""}...`);const C=t.map(f=>({name:f.name,type:f.type,size:f.size,fileId:Ze(),lastModified:f.lastModified})),N=await Je(C,b);c(20),d("Registering secure vault...");const P=t.map((f,D)=>({fileId:C[D].fileId,chunks:Math.ceil(f.size/Y),size:f.size})),E=await z.mutateAsync({expiresIn:s[0],maxDownloads:i[0],encryptedMetadata:N,lookupId:M.lookupId,wrappedKey:R,files:P});c(30),l("uploading"),x("transfer");const H=P.reduce((f,D)=>f+D.chunks,0);let T=0;const I=new Worker(new URL("/assets/encryption.worker-CKNeU3-a.js",import.meta.url),{type:"module"}),U=(f,D)=>new Promise((G,L)=>{const V=Math.random(),A=B=>{B.data.id===V&&(I.removeEventListener("message",A),B.data.type==="error"?L(B.data.error):G({iv:B.data.iv,encryptedData:B.data.encryptedData}))};I.addEventListener("message",A),I.postMessage({type:"encrypt",data:f,key:D,id:V},[f])});for(let f=0;f<t.length;f++){const D=t[f],G=C[f].fileId,L=Math.ceil(D.size/Y),V=_(D.name);for(let A=0;A<L;A++){const B=L>1?` (Chunk ${A+1}/${L})`:"",ie=t.length>1?`File ${f+1}/${t.length}: `:"";d(`${ie}Encrypting ${V}${B}`);const oe=A*Y,Me=Math.min(oe+Y,D.size),Pe=await D.slice(oe,Me).arrayBuffer(),{iv:Z,encryptedData:le}=await U(Pe,b),W=new Uint8Array(Z.byteLength+le.byteLength);W.set(Z,0),W.set(new Uint8Array(le),Z.byteLength),d(`${ie}Uploading ${V}${B}`);const{uploadUrl:Ee,storagePath:Ie}=await S.mutateAsync({vaultId:E.id,fileId:G,chunkIndex:A,size:W.byteLength});await fetch(Ee,{method:"PUT",body:W}),await j.mutateAsync({vaultId:E.id,fileId:G,chunkIndex:A,storagePath:Ie}),T++,c(30+T/H*65)}}I.terminate(),x("done"),c(100),d("Vault created successfully!"),l("success"),setTimeout(()=>{g(`/success/${E.id}#code=${M.fullCode}`)},800)}catch(b){console.error(b),l("idle"),y({variant:"destructive",title:"Upload Failed",description:b instanceof Error?b.message:"An error occurred"})}}};return e.jsxs("div",{className:"min-h-screen relative overflow-hidden flex flex-col",children:[e.jsx("div",{className:"fixed inset-0 grid-bg opacity-50"}),e.jsx("div",{className:"scanline"}),e.jsx("div",{className:"fixed top-0 left-1/2 -translate-x-1/2 w-[800px] h-[600px] bg-primary/5 rounded-full blur-[120px] pointer-events-none"}),e.jsx("header",{className:"relative z-10 px-4 md:px-6 py-6 md:py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto flex items-center justify-between",children:[e.jsx(ce,{href:"/",children:e.jsxs(k.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"flex items-center gap-3 cursor-pointer hover:opacity-80 transition-opacity",children:[e.jsx("div",{className:"w-8 h-8 md:w-10 md:h-10 bg-primary/20 rounded-xl flex items-center justify-center border border-primary/30 overflow-hidden",children:e.jsx("img",{src:"/vault-logo.jpg",alt:"VaultBridge",className:"w-full h-full object-cover p-1"})}),e.jsx("div",{children:e.jsxs("h1",{className:"text-lg md:text-xl font-bold font-mono tracking-tight",children:["VAULT",e.jsx("span",{className:"text-primary",children:"BRIDGE"})]})})]})}),e.jsx(ce,{href:"/",children:e.jsxs(J,{variant:"ghost",size:"sm",className:"gap-2",children:[e.jsx(Qe,{className:"w-4 h-4"}),"Back"]})})]})}),e.jsxs("main",{className:"relative z-10 flex-1 w-full max-w-2xl mx-auto px-4 md:px-6 py-8",children:[e.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center mb-8 md:mb-10",children:[e.jsx("div",{className:"flex items-center justify-center gap-3 mb-4",children:e.jsx("div",{className:"p-3 rounded-xl bg-primary/20 border border-primary/30",children:e.jsx(me,{className:"w-6 h-6 md:w-8 md:h-8 text-primary"})})}),e.jsx("h2",{className:"text-2xl md:text-3xl font-bold mb-2",children:"Upload Files"}),e.jsx("p",{className:"text-sm md:text-base text-muted-foreground",children:"Create a secure, encrypted vault for your files"})]}),e.jsxs(k.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:.1},className:`glass-card p-6 md:p-8 relative ${p?"dropzone-glow active":""}`,children:[e.jsx(ue,{children:n!=="idle"&&e.jsx(k.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-background/95 backdrop-blur-sm z-20 flex flex-col items-center justify-center p-6 md:p-8 rounded-2xl",children:e.jsx(at,{stage:n,step:m,progress:v,statusText:h})})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(nt,{onFilesSelected:b=>{if(b.some(R=>R.size>524288e3)){y({variant:"destructive",title:"File too large",description:"Max file size is 500MB for Vault mode."});return}r(b)},disabled:n!=="idle",onDragStateChange:w}),e.jsx("div",{className:"flex justify-center",children:e.jsx("span",{className:"px-2 py-1 rounded-md bg-primary/10 border border-primary/20 text-[10px] font-mono uppercase tracking-wider text-primary",children:"Max 500MB ‚Ä¢ AES-256-GCM"})})]}),e.jsxs("div",{className:"mt-8 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("label",{className:"text-sm text-muted-foreground flex items-center gap-2",children:[e.jsx(st,{className:"w-4 h-4"}),"Expires In"]}),e.jsxs("span",{className:"text-sm font-mono text-primary font-bold",children:[s[0],"h"]})]}),e.jsx(se,{value:s,onValueChange:a,min:1,max:168,step:1})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("label",{className:"text-sm text-muted-foreground flex items-center gap-2",children:[e.jsx(et,{className:"w-4 h-4"}),"Downloads"]}),e.jsx("span",{className:"text-sm font-mono text-primary font-bold",children:i[0]===1?"BURN ON READ":`${i[0]}x`})]}),e.jsx(se,{value:i,onValueChange:o,min:1,max:100,step:1,disabled:i[0]===1,className:i[0]===1?"opacity-50":""}),e.jsx(J,{variant:i[0]===1?"destructive":"outline",size:"sm",className:"w-full text-xs h-8",onClick:()=>o(i[0]===1?[5]:[1]),children:i[0]===1?"üî• Burn-on-read Active":"Enable Burn-on-read"})]})]}),e.jsx(J,{onClick:K,disabled:t.length===0||n!=="idle",className:"w-full h-12 md:h-14 cyber-btn text-base",children:n==="encrypting"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-current border-t-transparent rounded-full animate-spin mr-3"}),"Encrypting..."]}):n==="uploading"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-current border-t-transparent rounded-full animate-spin mr-3"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(tt,{className:"w-5 h-5 mr-3"}),"Secure & Upload"]})})]})]}),e.jsx(k.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"mt-8 text-center px-4",children:e.jsxs("p",{className:"text-xs md:text-sm text-muted-foreground",children:["üîê Files are encrypted in your browser with AES-256-GCM before upload.",e.jsx("br",{className:"hidden md:block"}),"We never see your files or encryption keys."]})})]})]})}export{Kt as default};
