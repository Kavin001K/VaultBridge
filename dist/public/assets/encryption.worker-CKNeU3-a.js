(function(){"use strict";self.onmessage=async r=>{const{type:o,id:c}=r.data;try{if(o==="encrypt"){const{data:e,key:a}=r.data,t=crypto.getRandomValues(new Uint8Array(12)),s=await crypto.subtle.encrypt({name:"AES-GCM",iv:t},a,e),n={type:"encrypt_success",id:c,iv:t,encryptedData:s};self.postMessage(n,[s,t.buffer])}else if(o==="decrypt"){const{data:e,iv:a,key:t}=r.data,s=await crypto.subtle.decrypt({name:"AES-GCM",iv:a},t,e),n={type:"decrypt_success",id:c,decryptedData:s};self.postMessage(n,[s])}}catch(e){self.postMessage({type:"error",id:c,error:e.message||"Unknown crypto error"})}}})();
